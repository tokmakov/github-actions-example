name: Test custom docker action

on: [push]

jobs:
  some-job:
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "do some job"
          sleep 5
          echo "job complete"
          exit $(( $RANDOM % 2 ))

  report:
    needs: some-job
    if: ${{ always() }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      #- uses: tokmakov/telegram-docker-action@master
      - uses: ./.github/actions/telegram-message
        with:
          chat: ${{ secrets.CHAT }}
          token: ${{ secrets.TOKEN }}
          result: ${{ needs.some-job.result }}
